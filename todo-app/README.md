# To-Doリストアプリ - AI Dev Day 2025 ワークショップ

## 概要
このTo-Doリストアプリは、AIエージェントとのペアプログラミングを体験するための教材です。
基本的なタスク管理機能を持つシンプルなWebアプリケーションで、3つの演習を通してAIエージェントとの協働開発を学習します。

## セットアップ

### 必要な環境
- Node.js 18.x以上
- VS Code with GitHub Copilot Agent Mode

### 起動手順
```bash
cd todo-app
npm install
npm start
```

### アクセス
- アプリケーション: http://localhost:3000
- API: http://localhost:3000/api/todos

## アプリケーションの使い方

このTo-Doリストアプリでは以下の操作ができます：

1. **タスク追加**: 入力欄にタスク名を入力して「追加」ボタンをクリック
2. **タスク表示**: 追加されたタスクが一覧で表示されます
3. **完了切り替え**: タスクをクリックすると完了/未完了を切り替えられます
4. **フィルタリング**: 「全て」「未完了」「完了」でタスクを絞り込み表示
5. **タスク削除**: 各タスクの「削除」ボタンでタスクを削除

まずはアプリを起動して、基本機能を試してみてください。

## ワークショップの進行

### 演習1: エージェントによるリファクタリング（45分）
既存コードの構造を改善します。まずはコードを保護するテストを追加してから、安全にリファクタリングを行います。

**やること**:
1. 既存機能の動作を保証するテストを作成
2. AIエージェントにリファクタリングを依頼
3. 提案された計画をレビューして承認
4. 改善結果を確認

### 演習2: TDD駆動開発（30分）
新機能を追加しながら、テスト駆動開発（TDD）のサイクルを体験します。

**やること**:
1. 新機能の仕様書（spec.md）を作成
2. 失敗するテストを先に作成（Red）
3. テストを通す最小限の実装（Green）
4. コードを改善（Refactor）

### 演習3: Playwright-MCP UI-TDD（45分）
外部ツールと連携して、UI自動テストを作成・実行します。

**やること**:
1. Playwright-MCPを使ってUIテストを自動生成
2. テストを通すようにUIを実装・改善
3. 外部ドキュメントから情報を取得して機能追加

## 現在のフォルダ構成

```
todo-app/
├── server.js           # Express サーバーとAPI
├── utils.js            # ユーティリティ関数
├── data.js             # データ操作
├── public/
│   ├── index.html      # メインUI
│   ├── app.js          # フロントエンドJavaScript
│   └── style.css       # スタイル
├── package.json        # プロジェクト設定
└── README.md           # このファイル
```

## 各演習のプロンプト例

### 演習1のプロンプト
```
既存のTo-Do機能をテストで保護してから、このアプリケーションをリファクタリングしてください。
APIロジックとフロントエンドロジックを適切に分離し、すべての関数が適切なファイルに配置されるようにし、
プロジェクト全体で変数名を分かりやすく改善してください。
```

### 演習2のプロンプト
```
#spec.md の仕様に基づいて、まず'/status'エンドポイントの失敗するテストを作成してください（Red）。
次に、テストを通す最小限の実装を行い（Green）、最後にコードを改善してください（Refactor）。
フロントエンド側でもステータス表示UIを同様のTDDサイクルで追加してください。
```

### 演習3のプロンプト
```
playwright-mcpツールを使用して、To-DoリストアプリのUI機能テスト（タスク追加・完了切り替え・削除）を先に作成してください（Red）。
その後、UIの実装や改善を行ってテストを通してください（Green）。
最後に、'tech-docs'ツールでレートリミット情報も取得し、適切な制限を実装してください（Refactor）。
```

## 現在のコードの設計問題（リファクタリング対象）

現在のコードには以下の問題が意図的に含まれています：

### server.js の問題
- APIルート、データ操作、バリデーションが全て混在
- 各エンドポイントで似たような処理が重複
- 変数名が不適切（`t`, `d`, `result` など）
- 設定値がハードコーディング

### utils.js の問題
- 日付処理、ID生成、バリデーション、文字列操作が混在
- To-Do以外の無関係な処理も含まれている
- 単一責任の原則に違反

### data.js の問題
- データアクセスとビジネスロジックが混在
- エラーハンドリングが不統一
- 適切でないデータ管理

### public/app.js の問題
- DOM操作とAPI通信が混在
- グローバル変数の乱用
- イベントハンドラーが直接結合

## 期待されるリファクタリング後の構造

```
todo-app/
├── controllers/
│   ├── todoController.js    # APIエンドポイント
│   └── statusController.js  # ステータス関連
├── services/
│   ├── todoService.js       # ビジネスロジック
│   └── validationService.js # バリデーション
├── models/
│   └── todo.js              # データモデル
├── utils/
│   ├── idGenerator.js       # ID生成
│   └── dateHelper.js        # 日付処理
├── public/
│   ├── js/
│   │   ├── todoApp.js       # メインアプリ
│   │   ├── todoService.js   # API通信
│   │   └── todoView.js      # DOM操作
│   └── index.html
├── tests/
│   ├── todo.test.js         # バックエンドテスト
│   └── todo.e2e.test.js     # Playwrightテスト
└── server.js                # エントリーポイント
```

## 学習のポイント

1. **AIエージェントとの協働**: 高レベルの目標設定と結果のレビュー
2. **テスト駆動開発**: Red-Green-Refactorサイクルの体験
3. **フルスタック開発**: API層とUI層の統合的な改善
4. **外部ツール連携**: MCPを活用した情報取得と活用

---

**重要**: このワークショップでは、AIエージェントが提案する計画を必ずレビューしてから承認してください。
人間がナビゲーター、AIエージェントがドライバーの役割を担う新しい協業スタイルを体験しましょう。